<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.0/css/font-awesome.css" integrity="sha512-72McA95q/YhjwmWFMGe8RI3aZIMCTJWPBbV8iQY3jy1z9+bi6+jHnERuNrDPo/WGYEzzNs4WdHNyyEr/yXJ9pA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="/public/css/style2.css">
  <title>Sign Up</title>
</head>

<body>
  <!-- Modal For Education -->
  <div class="modal fade bd-example-modal-lg" id="exampleModalEDU" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Add Academic Details</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">x</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-row">
            <div class="form-group col-md-6">
              <label for="inputstartyear4">Start Year</label>
              <input type="date" class="form-control" id="inputstartyear4" />
            </div>
            <div class="form-group col-md-6">
              <label for="inputcompletionyear4">Completion Year</label>
              <input type="date" class="form-control" id="inputcompletionyear4" />
            </div>
            <div class="form-group col-md-6">
              <label for="inputdegree4">Degree</label>
              <input type="text" class="form-control" id="inputdegree4" />
            </div>
            <div class="form-group col-md-6">
              <label for="inputspecialization4">Specialization</label>
              <input type="text" class="form-control" id="inputspecialization4" />
            </div>
            <div class="form-group col-md-6">
              <label for="inputuniversity4">University</label>
              <input type="text" class="form-control" id="inputuniversity4" />
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary form-button education-modal-button-add-row" data-dismiss="modal">Add</button>
        </div>
      </div>
    </div>
  </div>
  <!-- END MODAL FOR EDUCATION -->

  <!-- Modal For Experience -->
  <div class="modal fade bd-example-modal-lg" id="exampleModalExp" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Add Experience Details</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">x</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-row">
            <div class="form-group col-md-6">
              <label for="inputjobtitle4">Job Title</label>
              <input type="text" class="form-control" id="inputjobtitle4" />
            </div>
            <div class="form-group col-md-6">
              <label for="inputcompany4">Company</label>
              <input type="text" class="form-control" id="inputcompany4" />
            </div>
            <div class="form-group col-md-6">
              <label for="inputstartdate4">Start Date</label>
              <input type="date" class="form-control" id="inputstartdate4" />
            </div>
            <div class="form-group col-md-6">
              <label for="inputenddate4">End Date</label>
              <input type="date" class="form-control" id="inputenddate4" />
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary form-button experience-modal-button-add-row" data-dismiss="modal">Add</button>
        </div>
      </div>
    </div>
  </div>
  <!-- END Modal For Experience -->

  <div class="form-container bg-white mt-3 p-3 rounded shadow">
    <div class="row">
      <div class="col-lg-3 form-side-nav mb-3">
        <nav class="navbar navbar-expand-lg navbar-light">
          <button class="navbar-toggler mb-2" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarText">
            <div id="list-example" class="list-group">
              <button id="personal-information-control" class="form-nav-controls activeControl list-group-item list-group-item-action">
                <i class="fa fa-user" aria-hidden="true"></i>
                Personal Information
              </button>
              <button id="education-control" class="form-nav-controls list-group-item list-group-item-action">
                <i class="fa fa-book" aria-hidden="true"></i>
                Education
              </button>
              <button id="experience-control" class="form-nav-controls list-group-item list-group-item-action">
                <i class="fa fa-briefcase" aria-hidden="true"></i>
                Experience
              </button>
              <button id="resume-control" class="form-nav-controls list-group-item list-group-item-action">
                <i class="fa fa-folder" aria-hidden="true"></i>
                Resume
              </button>
            </div>
          </div>
        </nav>
      </div>

      <div class="col-lg-9 form-col">
        <div>
          <form id="applicant-profile-form" class="form" role="form" method="POST" action="/create/applicant-profile">
            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
            <!-- personal information -->
            <div class="form-part personal-information showForm" id="personal-information">
              <h4 class="d-flex align-items-center border-bottom pb-3 mb-4 form-title" id="personal-information">
                <i class="form-icon fa fa-user" aria-hidden="true"></i>
                <span class="ml-3">Personal Information</span>
              </h4>
              <div class="form-row">
                <div class="form-group col-md-4">
                  <label for="inputfirstname4">First Name</label>
                  <input type="text" class="required form-control" name="first_name" id="inputfirstname4" required="required" />
                </div>
                <div class="form-group col-md-4">
                  <label for="inputlastname4">Last Name</label>
                  <input type="text" class="required form-control" name="last_name" id="inputlastname4" required="required" />
                </div>
                <div class="form-group col-md-4">
                  <label for="inputfathername4">Father Name</label>
                  <input type="text" class="required form-control" name="father_name" id="inputfathername4" required="required" />
                </div>
              </div>

              <div class="form-row">
                <div class="form-group col-md-4">
                  <label for="inputGender">Gender</label>
                  <select id="inputGender" name="gender" class="required form-control" required="required">
                    <option selected="1">Choose...</option>
                    <option value="male"> Male </option>
                    <option value="female"> Female </option>
                  </select>
                </div>
                <div class="form-group col-md-4">
                  <label for="inputHighestEducation">Highest Education</label>
                  <select id="inputHighestEducation" name="highest_education" class="required form-control" required="required">
                    <option selected="1">Choose...</option>
                    <option value="illiterate"> Illiterate </option>
                    <option value="primary"> Primary </option>
                    <option value="grade"> Grade 12 </option>
                    <option value="grade"> Grade 14 </option>
                    <option value="bachelor"> Bachelor </option>
                    <option value="master"> Master </option>
                    <option value="doctorate"> Doctorate </option>
                  </select>
                </div>
                <div class="form-group col-md-4">
                  <label for="inputDateOfBirth4">Date of Birth</label>
                  <input type="date" class="required form-control" name="date_of_birth" id="inputDateOfBirth4" required="required" />
                </div>
              </div>

              <div class="form-row">
                <div class="form-group col-md-4">
                  <label for="inputcountry4">Country</label>
                  <input type="text" class="required form-control" name="country" id="inputcountry4" required="required" />
                </div>
                <div class="form-group col-md-4">
                  <label for="inputemail4">Email</label>
                  <input type="email" class="required form-control" name="email" id="inputemail4" required="required" />
                </div>
                <div class="form-group col-md-4">
                  <label for="inputphone4">Phone</label>
                  <input type="number" class="required form-control" name="phone" id="inputphone4" required="required" />
                </div>
              </div>
            </div>
            <!-- end personal information -->

            <!-- education -->
            <div class="form-part education hideForm" id="education">
              <h4 class="d-flex align-items-center border-bottom pb-3 mb-4 form-title" id="personal-information">
                <i class="form-icon fa fa-book" aria-hidden="true"></i>
                <span class="ml-3">Education</span>
              </h4>
              <div class="form-row table-responsive">
                <input type="hidden" name="start_yearEdu" class="required start-year" required="required"></input>
                <input type="hidden" name="completion_yearEdu" class="required completion-year" required="required"></input>
                <input type="hidden" name="degree" class="required degree" required="required"></input>
                <input type="hidden" name="specialization" class="required Specialization" required="required"></input>
                <input type="hidden" name="university" class="required University" required="required"></input>
                <table name="education" id="education-table" class="table table-striped shadow text-center">
                  <thead>
                    <tr>
                      <th scope="col">Start Year</th>
                      <th scope="col">Completion Year</th>
                      <th scope="col">Degree</th>
                      <th scope="col">Specialization</th>
                      <th scope="col">University</th>
                      <th scope="col">Actions</th>
                    </tr>
                  </thead>
                  <tbody id="education-table-body"></tbody>
                </table>
              </div>
              <button type="button" class="btn btn-primary form-button float-right mt-3" data-toggle="modal" data-target="#exampleModalEDU">Add New</button>
            </div>
            <!-- end education -->

            <!-- experience -->
            <div class="form-part experience hideForm" id="experience">
              <h4 class="d-flex align-items-center border-bottom pb-3 mb-4 form-title" id="personal-information">
                <i class="form-icon fa fa-briefcase" aria-hidden="true"></i>
                <span class="ml-3">Experience</span>
              </h4>
              <div class="form-row table-responsive">
                <input type="hidden" name="job_title" class="required job-title" required="required"></input>
                <input type="hidden" name="company" class="required company" required="required"></input>
                <input type="hidden" name="start_date_exp" class="required start-date-exp" required="required"></input>
                <input type="hidden" name="end_date_exp" class="required end-date-exp" required="required"></input>
                <table id="experience-table" class="table table-striped shadow text-center">
                  <thead>
                    <tr>
                      <th scope="col">Job Title</th>
                      <th scope="col">Company</th>
                      <th scope="col">Start Date</th>
                      <th scope="col">End Date</th>
                      <th scope="col">Actions</th>
                    </tr>
                  </thead>
                  <tbody id="experience-table-body"></tbody>
                </table>
              </div>
              <button type="button" id="modalexp" class="btn btn-primary form-button float-right mt-3" data-toggle="modal" data-target="#exampleModalExp">Add New</button>
            </div>
            <!-- end experience -->

            <!-- resume -->
            <div class="form-part resume hideForm" id="resume">
              <h4 class="d-flex align-items-center border-bottom pb-3 mb-4 form-title" id="personal-information">
                <i class="form-icon fa fa-folder" aria-hidden="true"></i>
                <span class="ml-3">Resume</span>
              </h4>
              <div class="form-group col-md-12">
                <label for="formFile" class="form-label">Please upload your most recent resume.</label>
                <input class="required form-control" type="file" name="cv" id="formFile" />
              </div>
            </div>
            <!-- end resume -->

          </form>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-12 d-flex justify-content-center mt-4">
      <button type="submit" id="form-submit" class="btn btn-primary form-button form-button-save m-auto">Save</button>
    </div>
  </div>
  <script src="/nl_recruitment/static/src/js/applicant_profile.js"></script>

  <script>
    form = document.getElementById("applicant-profile-form");
formParts = document.querySelectorAll(".form-part");
educationModalButton = document.querySelector(
  ".education-modal-button-add-row"
);
experienceModalButton = document.querySelector(
  ".experience-modal-button-add-row"
);
personalInformation = document.getElementById("personal-information");
education = document.getElementById("education");
experience = document.getElementById("experience");
resume = document.getElementById("resume");
personalInformationControl = document.getElementById(
  "personal-information-control"
);
educationControl = document.getElementById("education-control");
experienceControl = document.getElementById("experience-control");
resumeControl = document.getElementById("resume-control");
startyear = document.getElementById("inputstartyear4");
completionyear = document.getElementById("inputcompletionyear4");
degree = document.getElementById("inputdegree4");
specialization = document.getElementById("inputspecialization4");
university = document.getElementById("inputuniversity4");
educationTableBody = document.getElementById("education-table-body");
formNavControls = document.querySelectorAll(".form-nav-controls");
experienceTableBody = document.getElementById("experience-table-body");
jobtitle = document.getElementById("inputjobtitle4");
company = document.getElementById("inputcompany4");
startdate = document.getElementById("inputstartdate4");
enddate = document.getElementById("inputenddate4");
modalExp = document.getElementById("modalexp");
formSubmit = document.getElementById("form-submit");

function openFormPart(formPart) {
  formParts.forEach((element) => {
    element.classList.remove("showForm");
    element.classList.add("hideForm");
  });
  formPart.classList.remove("hideForm");
  formPart.classList.add("showForm");
}

function switchActive(control) {
  formNavControls.forEach((element) => {
    element.classList.remove("activeControl");
  });
  control.classList.add("activeControl");
}

personalInformationControl.addEventListener("click", function () {
  switchActive(personalInformationControl);
  openFormPart(personalInformation);
});

educationControl.addEventListener("click", function () {
  switchActive(educationControl);
  openFormPart(education);
});

experienceControl.addEventListener("click", function () {
  switchActive(experienceControl);
  openFormPart(experience);
});

resumeControl.addEventListener("click", function () {
  switchActive(resumeControl);
  openFormPart(resume);
});

function addRow(field1, field2, field3, field4, field5, tableBody) {
  tr = document.createElement("tr");

  if (field5) {
    tr.innerHTML = `
            <td><input type="date" class="startYearTB table-input" value="${field1.value}" required="required"/></td>
            <td><input type="date" class="completionYearTB table-input" value="${field2.value}" required="required"/></td>
            <td><input type="text" class="degreeTB table-input" value="${field3.value}" required="required"/></td>
            <td><input type="text" class="specializationTB table-input" value="${field4.value}" required="required"/></td>
            <td><input type="text" class="universityTB table-input" value="${field5.value}" required="required"/></td>        
            <td>
                <button type="button" class="trash-delete-row btn" style="margin-top: 10px;"><i class="fa fa-times" aria-hidden="true"></i></button>
            </td>`;
  } else if (!field5) {
    tr.innerHTML = `
            <td><input type="text" class="job-titleTB table-input" value="${field1.value}" required="required"/></td>
            <td><input type="text" class="companyTB table-input" value="${field2.value}" required="required"/></td>
            <td><input type="date" class="start-date-expTB table-input" value="${field3.value}" required="required"/></td>
            <td><input type="date" class="end-date-expTB table-input" value="${field4.value}" required="required"/></td>
            <td>
                <button type="button" class="trash-delete-row btn" style="margin-top: 10px;"><i class="fa fa-times" aria-hidden="true"></i></button>
            </td>`;
  }

  tableBody.appendChild(tr);
  field1.value = field2.value = field3.value = field4.value = field5.value = "";

  deleteRowBtns = document.querySelectorAll(".trash-delete-row");
  deleteRow(deleteRowBtns);
}

educationModalButton.addEventListener("click", function () {
  addRow(
    startyear,
    completionyear,
    degree,
    specialization,
    university,
    educationTableBody
  );
});

experienceModalButton.addEventListener("click", function () {
  addRow(jobtitle, company, startdate, enddate, "", experienceTableBody);
});

function deleteRow(deleteRowBtns) {
  deleteRowBtns.forEach((element) => {
    element.addEventListener("click", function () {
      element.parentNode.parentNode.remove();
    });
  });
}

function updateHiddenInput(tb_input, values, hiddenInput) {
  tb_input.forEach((el) => {
    values.push(el.value);
    hiddenInput.value = values.join(",");
  });
}

function save() {
  // Taking data from education table
  startYearTB = document.querySelectorAll(".startYearTB");
  completionYearTB = document.querySelectorAll(".completionYearTB");
  degreeTB = document.querySelectorAll(".degreeTB");
  specializationTB = document.querySelectorAll(".specializationTB");
  universityTB = document.querySelectorAll(".universityTB");
  startYearHiddenInput = document.querySelector(".start-year");
  completionYearHiddenInput = document.querySelector(".completion-year");
  degreeHiddenInput = document.querySelector(".degree");
  SpecializationHiddenInput = document.querySelector(".Specialization");
  UniversityHiddenInput = document.querySelector(".University");
  startYears = [];
  completionYears = [];
  degrees = [];
  specializations = [];
  universities = [];
  updateHiddenInput(startYearTB, startYears, startYearHiddenInput);
  updateHiddenInput(
    completionYearTB,
    completionYears,
    completionYearHiddenInput
  );
  updateHiddenInput(degreeTB, degrees, degreeHiddenInput);
  updateHiddenInput(
    specializationTB,
    specializations,
    SpecializationHiddenInput
  );
  updateHiddenInput(universityTB, universities, UniversityHiddenInput);
  // Taking data from experience table
  jobTitleTB = document.querySelectorAll(".job-titleTB");
  companyTB = document.querySelectorAll(".companyTB");
  startDateExpTB = document.querySelectorAll(".start-date-expTB");
  endDateExpTB = document.querySelectorAll(".end-date-expTB");
  jobTitleHiddenInput = document.querySelector(".job-title");
  companyHiddenInput = document.querySelector(".company");
  startDateExpHiddenInput = document.querySelector(".start-date-exp");
  endDateExpHiddenInput = document.querySelector(".end-date-exp");
  jobTitles = [];
  companies = [];
  startDateExps = [];
  endDateExps = [];
  updateHiddenInput(jobTitleTB, jobTitles, jobTitleHiddenInput);
  updateHiddenInput(companyTB, companies, companyHiddenInput);
  updateHiddenInput(startDateExpTB, startDateExps, startDateExpHiddenInput);
  updateHiddenInput(endDateExpTB, endDateExps, endDateExpHiddenInput);
}

function validate() {
  requiredInputs = document.querySelectorAll(".required");
  save();
  validatedInputs = [];
  notValidatedInputs = [];
  for (let i = 0; i < requiredInputs.length; i++) {
    if (requiredInputs[i].value) {
      validatedInputs.push(requiredInputs[i]);
    } else {
      notValidatedInputs.push(requiredInputs[i]);
    }
  }
  if (validatedInputs.length === requiredInputs.length) {
    form.submit();
  } else {
    alert("Please fill all the required fields.");
    validatedInputs.forEach((el) => {
      el.style.border = "1px solid #CED4DA";
    });
    notValidatedInputs.forEach((el) => {
      el.style.border = "solid 1px red";
    });
  }
}

formSubmit.addEventListener("click", validate);

  </script>
</body>

</html>